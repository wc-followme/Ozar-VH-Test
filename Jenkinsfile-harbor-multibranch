@Library('jenkins-shared-library@production') _

def gitUrl = "https://github.com/CodezerosDev/envision-web.git"
def componentName = gitUrl.tokenize('/')[-1].replace('.git', '')
def project = 'envision-development'

// Define file paths - required when configFiles is used
def filePaths = [
    qa: "file:///home/ubuntu/env/envision-development/web"
]

// Branch definitions with mixed configuration approaches and branch-specific website_url where applicable
def branch_definitions = [
    'qa': [
        // Simple array of strings for standard files
        configFiles: [
            "${filePaths.qa}/.env"
        ],
        agent         : 'wdcs-arm64-agent',
        imageName     : "qa-${componentName}",
        namespace     : 'dev',
        deployment    : 'envision-development-web',
        hostIP        : '43.204.64.131',
        sshCreds      : 'wdcs-eks-bastion',
        sshUser       : 'wdcs-dev',
        deploy_option : 'yes',
        website_url   : 'https://envision-web.qa.webcluesstaging.com'
    ]
]

// Call the Combined function with branchDefinitions and other global settings
BuildDeploy(
    branchDefinitions: branch_definitions,
    docker: [
        project  : project,
        gitUrl   : gitUrl,
        gitCreds : 'Codezerosdev-git'
    ],
    notifications: [
        slack: [
            channel: '#proj-envision'
        ],
        email: [
            recipients: ['yash@webcluesinfotech.com'],
            replyTo: ['harsh.solanki@codezeros.com']
        ]
    ],
    kube: [:]
)